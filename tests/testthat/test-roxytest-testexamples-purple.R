# Generated by roxytest: Do not edit by hand!
# Last updated: 2020-04-09 17:52:05

context("File R/purple.R: @testexamples")

test_that("Function read_purple_cnv_gene() @ L21", {
  
  x <- system.file("extdata/purple/v2.39/purple.cnv.gene.tsv", package = "gpgr")
  (p <- read_purple_cnv_gene(x, "2.39"))
  
  expect_equal(colnames(p)[ncol(p)], "minMinorAllelePloidy")
  expect_error(read_purple_cnv_gene(x, "2.38"))
})


test_that("Function process_purple_cnv_gene() @ L83", {
  
  x <- system.file("extdata/purple/v2.39/purple.cnv.gene.tsv", package = "gpgr")
  g <- system.file("extdata/ref/umccr_cancer_genes_2019-03-20.tsv", package = "gpgr")
  (pp <- process_purple_cnv_gene(x, g)$tab)
  
  expect_equal(colnames(pp)[ncol(pp)], "minRegSupportStartEndMethod")
  expect_error(process_purple_cnv_gene(x, "2.38"))
})


test_that("Function read_purple_cnv_somatic() @ L154", {
  
  x <- system.file("extdata/purple/v2.39/purple.cnv.somatic.tsv", package = "gpgr")
  (p <- read_purple_cnv_somatic(x, "2.39"))
  
  expect_equal(colnames(p)[ncol(p)], "majorAllelePloidy")
  expect_error(read_purple_cnv_somatic(x, "2.38"))
})


test_that("Function process_purple_cnv_somatic() @ L206", {
  
  x <- system.file("extdata/purple/v2.39/purple.cnv.somatic.tsv", package = "gpgr")
  (pp <- process_purple_cnv_somatic(x)$tab)
  
  expect_equal(colnames(pp)[ncol(pp)], "GC (windowCount)")
  expect_error(process_purple_cnv_somatic(x, "2.38"))
})


test_that("Function read_purple_cnv_germline() @ L268", {
  
  x <- system.file("extdata/purple/v2.39/purple.cnv.germline.tsv", package = "gpgr")
  (p <- read_purple_cnv_germline(x, "2.39"))
  
  expect_equal(colnames(p)[ncol(p)], "majorAllelePloidy")
  expect_error(read_purple_cnv_somatic(x, "2.38"))
})


test_that("Function process_purple_cnv_germline() @ L294", {
  
  x <- system.file("extdata/purple/v2.39/purple.cnv.germline.tsv", package = "gpgr")
  (pp <- process_purple_cnv_germline(x)$tab)
  
  expect_equal(colnames(pp)[ncol(pp)], "GC (windowCount)")
  expect_error(process_purple_cnv_germline(x, "2.38"))
})


test_that("Function read_purple_version() @ L320", {
  
  x <- system.file("extdata/purple/v2.39/purple.version", package = "gpgr")
  (v <- read_purple_version(x))
  
  expect_equal(length(v), 2)
  expect_equal(names(v), c("version", "build_date"))
  expect_equal(v$version, "2.39")
})


test_that("Function read_purple_qc() @ L346", {
  
  x <- system.file("extdata/purple/v2.39/purple.qc", package = "gpgr")
  (p <- read_purple_qc(x))
  
  expect_true(inherits(p, "tbl_df"))
})


test_that("Function read_purple_purity() @ L399", {
  
  x <- system.file("extdata/purple/v2.39/purple.purity.tsv", package = "gpgr")
  (p <- read_purple_purity(x))
  
  expect_equal(colnames(p)[ncol(p)], "tmbStatus")
  expect_error(read_purple_purity(x, "2.38"))
})

